var mongoose = require('mongoose'),    Schema = mongoose.Schema,    _ = require("lodash");//var Avatar = new Schema({//    type: { type: Number},//    path: { type: String }//}, { _id: false });var User = new Schema({    id         : {type: String, index: true },    name       : {type: String },    nickname   : {type: String },    email      : {type: String },    avatar     : {        type: { type: Number, default: 1 },//1:remote url        path: { type: String, default: '' }    },    desc       : {type: String, default: ''},    password   : {type: String},    salt       : {type: String},    is_deleted : {type: Number, default: 0}, // 0: false; 1: true;    status     : {type: Number, default: 1 }, // 1: ok, 2: need to mail confirm    role       : {type: Number, default: 1},//1.member,2.admin,3.supper admin    online     : {type: Number, default: 0},    create_date: {type: Number, default: Date.now},    update_date: {type: Number, default: Date.now}});User.virtual('display_name').get(function () {    return this.nickname || this.name;});User.methods = {    makeSimple: function () {        var result = _.pick(this, 'id', 'name', 'nickname', 'email', 'avatar', 'status', 'role','display_name','desc');        if (result.avatar.type == 1 && _.isEmpty(result.avatar.path)) {            result.avatar.path = "/img/default_avatar.png";        }        return result;    }};User.statics = {};module.exports = User;